language: c
compiler:
  - gcc
  - clang
cache: apt
branches:
  only:
    - master
before_install:
  - lsb_release -a
  - sudo apt-get update -qq
  - sudo apt-get install update-manager-core software-properties-common
  - sudo sed -i 's/^\(Prompt=\).*/\1lts/' /etc/update-manager/release-upgrades
  - sudo do-release-upgrade -d -f DistUpgradeViewNonInteractive
  - sudo add-apt-repository -y ppa:vala-team/ppa
  - sudo apt-get update -qq
  - sudo apt-get install -qq gnome-common libglib2.0-dev libgtk-3-dev 
         libsqlite3-dev libvala-0.28-dev valac-0.28 libgee-0.8 gobject-introspection
  - sudo pip install cpp-coveralls
script:
  - cmake -D DEBUG=ON -D ADD_COVERAGE=ON .
  - make -j2
after_success:
  - coveralls --exclude lib --exclude tests
